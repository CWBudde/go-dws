// Jensen's Device - Classic demonstration of lazy parameter evaluation
// Computes sum of a series where the term expression is re-evaluated each iteration
// This requires lazy parameters because the term must see the updated loop variable

var globalI: Integer;

// Sum function using lazy parameter for the term
// The term expression is re-evaluated on each iteration
function sum(lo, hi: Integer; lazy term: Float): Float;
begin
   Result := 0.0;
   globalI := lo;
   while globalI <= hi do begin
      Result := Result + term;  // term is re-evaluated each iteration with current globalI
      globalI := globalI + 1;
   end;
end;

var harmonic: Float;
var sumOfSquares: Float;
var i: Integer;

begin
   // Example 1: Harmonic series H(5) = 1/1 + 1/2 + 1/3 + 1/4 + 1/5
   harmonic := sum(1, 5, 1.0 / globalI);
   PrintLn('Harmonic series H(5) = ' + FloatToStr(harmonic));

   // Example 2: Sum of squares 1^2 + 2^2 + 3^2 + 4^2 + 5^2
   sumOfSquares := 0.0;
   for i := 1 to 5 do
      sumOfSquares := sumOfSquares + i * i;
   PrintLn('Sum of squares 1-5 = ' + FloatToStr(sumOfSquares));

   // Example 3: Harmonic series H(10)
   harmonic := sum(1, 10, 1.0 / globalI);
   PrintLn('Harmonic series H(10) = ' + FloatToStr(harmonic));
end.
